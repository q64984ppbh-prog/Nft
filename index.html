<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üéÆ Crash</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: #0f0f17;
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            padding-bottom: env(safe-area-inset-bottom);
        }

        .gif-section {
            height: 50vh;
            background: #1a1a25;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .rocket-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 200px;
            z-index: 10;
        }

        .rocket-gif {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: none;
        }

        .rocket-gif.active {
            display: block;
        }

        .current-game-display {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            text-align: center;
            z-index: 20;
        }

        .current-game-value {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .current-game-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
        }

        .history-section {
            flex: 1;
            padding: 20px;
            background: #0f0f17;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .history-title {
            text-align: center;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 15px;
            font-weight: 500;
        }

        .history-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .history-item {
            background: #1a1a25;
            border-radius: 10px;
            padding: 12px;
            min-width: 60px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-current {
            background: #40e0d0;
            border: none;
        }

        .history-value {
            font-size: 18px;
            font-weight: 700;
            color: white;
        }

        .history-current .history-value {
            color: #0f0f17;
        }

        .separator {
            color: rgba(255, 255, 255, 0.3);
            font-weight: bold;
        }

        .control-section {
            padding: 20px;
            background: #0f0f17;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bet-button {
            width: 100%;
            padding: 18px;
            background: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 800;
            color: #0f0f17;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .bet-button:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        .bet-button:active {
            transform: translateY(0);
        }

        .bet-button.cash-out {
            background: #40e0d0;
            color: #0f0f17;
        }

        .bet-button.cash-out:hover {
            background: #50f0e0;
        }

        .bet-button:disabled {
            background: #3a3a4a;
            color: rgba(255, 255, 255, 0.3);
            cursor: not-allowed;
            transform: none;
        }

        .hidden {
            display: none;
        }

        @keyframes rocketShake {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-3deg); }
            50% { transform: translate(-50%, -50%) rotate(3deg); }
            75% { transform: translate(-50%, -50%) rotate(-2deg); }
            100% { transform: translate(-50%, -50%) rotate(0deg); }
        }

        .rocket-shake {
            animation: rocketShake 0.3s ease-in-out infinite;
        }

        @keyframes explosionFlash {
            0% { background-color: transparent; }
            50% { background-color: rgba(255, 107, 157, 0.2); }
            100% { background-color: transparent; }
        }

        .explosion-flash {
            animation: explosionFlash 0.5s ease-out;
        }

        .vibration {
            animation: vibration 0.1s linear infinite;
        }

        @keyframes vibration {
            0% { transform: translate(-50%, -50%) translateX(0); }
            25% { transform: translate(-50%, -50%) translateX(-2px); }
            50% { transform: translate(-50%, -50%) translateX(0); }
            75% { transform: translate(-50%, -50%) translateX(2px); }
            100% { transform: translate(-50%, -50%) translateX(0); }
        }
    </style>
</head>
<body>
    <div class="gif-section" id="gifSection">
        <div class="current-game-display">
            <div class="current-game-value" id="currentMultiplier">1.00x</div>
            <div class="current-game-label">–¢–ï–ö–£–©–ê–Ø –ò–ì–†–ê</div>
        </div>
        <div class="rocket-container" id="rocketContainer">
            <img src="gifs/polet.gif" class="rocket-gif" id="rocketGif">
            <img src="gifs/bomba.gif" class="rocket-gif" id="explosionGif">
        </div>
    </div>

    <div class="history-section">
        <div class="history-title">–ü–†–ï–î–´–î–£–©–ò–ï –ò–ö–°–´</div>
        <div class="history-display">
            <div class="history-item history-current">
                <div class="history-value" id="currentMultiplier2">1.00</div>
            </div>
            <div class="separator">|</div>
            <div class="history-item">
                <div class="history-value" id="history1">1.00</div>
            </div>
            <div class="separator">|</div>
            <div class="history-item">
                <div class="history-value" id="history2">2.54</div>
            </div>
            <div class="separator">|</div>
            <div class="history-item">
                <div class="history-value" id="history3">3.60</div>
            </div>
            <div class="separator">|</div>
            <div class="history-item">
                <div class="history-value" id="history4">1.00</div>
            </div>
        </div>
    </div>

    <div class="control-section">
        <button id="placeBetBtn" class="bet-button">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
        <button id="cashOutBtn" class="bet-button cash-out hidden">–ó–∞–±—Ä–∞—Ç—å</button>
    </div>

    <script>
        let gameActive = false;
        let multiplier = 1.00;
        let crashPoint = null;
        let balance = 5000;
        let currentBet = null;
        let gameLoopId = null;
        let launchTimerId = null;
        let launchTimer = 10.0;
        let history = [1.00, 2.54, 3.60, 1.00];
        let vibrationSupported = 'vibrate' in navigator;

        function initGame() {
            updateHistoryDisplay();
            startLaunchTimer();
            setupGIFs();
        }

        function setupGIFs() {
            const rocketGif = document.getElementById('rocketGif');
            const explosionGif = document.getElementById('explosionGif');
            
            rocketGif.onerror = () => {
                rocketGif.style.display = 'none';
                showEmoji('üöÄ');
            };
            
            explosionGif.onerror = () => {
                explosionGif.style.display = 'none';
                showEmoji('üí•');
            };
        }

        function showEmoji(emoji) {
            const container = document.getElementById('rocketContainer');
            const emojiEl = document.createElement('div');
            emojiEl.style.fontSize = '80px';
            emojiEl.style.textAlign = 'center';
            emojiEl.textContent = emoji;
            container.appendChild(emojiEl);
        }

        function startLaunchTimer() {
            if (launchTimerId) clearInterval(launchTimerId);
            
            launchTimer = 10.0;
            launchTimerId = setInterval(() => {
                launchTimer -= 0.1;
                
                if (launchTimer <= 0) {
                    clearInterval(launchTimerId);
                    if (!gameActive) {
                        startAutoGame();
                    }
                }
            }, 100);
        }

        function startAutoGame() {
            if (gameActive) return;
            
            gameActive = true;
            multiplier = 1.00;
            crashPoint = generateCrashPoint();
            
            document.getElementById('rocketGif').style.display = 'block';
            document.getElementById('rocketGif').classList.add('active');
            document.getElementById('explosionGif').style.display = 'none';
            document.getElementById('explosionGif').classList.remove('active');
            document.getElementById('rocketContainer').classList.remove('rocket-shake', 'vibration');
            
            updateMultiplier();
            startGameLoop();
        }

        function generateCrashPoint() {
            const r = Math.random();
            const houseEdge = 0.02;
            return Math.floor(100 * (1 - houseEdge) / (1 - r)) / 100;
        }

        function startGameLoop() {
            if (gameLoopId) cancelAnimationFrame(gameLoopId);
            
            const startTime = Date.now();
            const gameLoop = () => {
                if (!gameActive) return;
                
                const elapsed = (Date.now() - startTime) / 1000;
                multiplier = 1.00 + (elapsed * elapsed * 0.25);
                
                updateMultiplier();
                
                if (multiplier > 3) {
                    document.getElementById('rocketContainer').classList.add('rocket-shake');
                }
                
                if (multiplier >= crashPoint) {
                    crashGame();
                } else {
                    gameLoopId = requestAnimationFrame(gameLoop);
                }
            };
            
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        function updateMultiplier() {
            const multiplierValue = multiplier.toFixed(2);
            document.getElementById('currentMultiplier').textContent = multiplierValue + 'x';
            document.getElementById('currentMultiplier2').textContent = multiplierValue;
        }

        function updateHistoryDisplay() {
            document.getElementById('history1').textContent = history[0].toFixed(2);
            document.getElementById('history2').textContent = history[1].toFixed(2);
            document.getElementById('history3').textContent = history[2].toFixed(2);
            document.getElementById('history4').textContent = history[3].toFixed(2);
        }

        function placeBet() {
            if (currentBet || gameActive) return;
            
            const betAmount = 100;
            
            if (betAmount > balance) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
                return;
            }
            
            currentBet = {
                amount: betAmount,
                cashedOut: false
            };
            
            balance -= betAmount;
            
            document.getElementById('placeBetBtn').classList.add('hidden');
            document.getElementById('cashOutBtn').classList.remove('hidden');
            
            if (!gameActive) {
                startAutoGame();
            }
        }

        function cashOut() {
            if (!currentBet || currentBet.cashedOut || !gameActive) return;
            
            currentBet.cashedOut = true;
            const winAmount = currentBet.amount * multiplier;
            balance += winAmount;
            
            document.getElementById('placeBetBtn').classList.remove('hidden');
            document.getElementById('cashOutBtn').classList.add('hidden');
            
            addToHistory(multiplier);
            currentBet = null;
        }

        function crashGame() {
            gameActive = false;
            
            document.getElementById('rocketGif').style.display = 'none';
            document.getElementById('rocketGif').classList.remove('active');
            document.getElementById('explosionGif').style.display = 'block';
            document.getElementById('explosionGif').classList.add('active');
            
            document.getElementById('gifSection').classList.add('explosion-flash');
            document.getElementById('rocketContainer').classList.add('vibration');
            
            if (vibrationSupported) {
                navigator.vibrate([200, 100, 200]);
            }
            
            if (currentBet && !currentBet.cashedOut) {
                currentBet = null;
                document.getElementById('placeBetBtn').classList.remove('hidden');
                document.getElementById('cashOutBtn').classList.add('hidden');
            }
            
            addToHistory(multiplier);
            
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
                gameLoopId = null;
            }
            
            setTimeout(() => {
                document.getElementById('gifSection').classList.remove('explosion-flash');
                document.getElementById('rocketContainer').classList.remove('vibration');
                resetGame();
                startLaunchTimer();
            }, 3000);
        }

        function addToHistory(newMultiplier) {
            history.unshift(newMultiplier);
            if (history.length > 4) {
                history.pop();
            }
            updateHistoryDisplay();
        }

        function resetGame() {
            gameActive = false;
            multiplier = 1.00;
            
            document.getElementById('rocketGif').style.display = 'none';
            document.getElementById('rocketGif').classList.remove('active');
            document.getElementById('explosionGif').style.display = 'none';
            document.getElementById('explosionGif').classList.remove('active');
            
            document.getElementById('rocketContainer').classList.remove('rocket-shake', 'vibration');
            
            updateMultiplier();
            
            if (currentBet) {
                document.getElementById('placeBetBtn').classList.remove('hidden');
                document.getElementById('cashOutBtn').classList.add('hidden');
                currentBet = null;
            }
        }

        document.addEventListener('DOMContentLoaded', initGame);
        
        document.getElementById('placeBetBtn').addEventListener('click', placeBet);
        document.getElementById('cashOutBtn').addEventListener('click', cashOut);
        
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.expand();
            Telegram.WebApp.setHeaderColor('#0f0f17');
            Telegram.WebApp.setBackgroundColor('#0f0f17');
        }
    </script>
</body>
</html>
